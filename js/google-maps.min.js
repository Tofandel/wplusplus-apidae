(function($){window.apidaeMaps=[];window.initApidaeMaps=function(){$(function(){$(".apidae-google-maps").each(function(){$(this).apidaeMap()})})};$.fn.apidaeMap=function(){$(this).each(function(){var settings=$(this).data();settings=$.extend({type:"roadmap",center:null,animation:"drop",delay:0,zoom:null,tilt:null,controls:false,disableUi:false,panorama:false,scrollwheel:true,draggable:true,panoramaHeading:0,panoramaPitch:0,panoramaControls:true,panoramaEffect:"slideLeft",mapStyle:null},settings);var map;var panorama;var markers=[];var pins=[];var bounds;var that=$(this);var panorama_margin;var init=function(container){if(settings["center"]==null&&pins.length>0){bounds=new google.maps.LatLngBounds;for(var i in pins){bounds.extend(pins[i]["position"])}var center=bounds.getCenter()}if(settings["type"].match(/^panorama$/i)){panorama=new google.maps.StreetViewPanorama(container,{position:center,addressControlOptions:{position:google.maps.ControlPosition.BOTTOM_CENTER},disableDefaultUI:!settings["panoramaControls"]})}else{map=new google.maps.Map(container,{zoom:settings["zoom"]||12,center:center,mapTypeControl:settings["controls"],disableDefaultUI:settings["disableUi"],scrollwheel:settings["scrollwheel"],draggable:settings["draggable"],styles:JSON.parse(decodeURIComponent(settings["mapStyle"])),mapTypeId:google.maps.MapTypeId[settings["type"].toUpperCase()]});window.apidaeMaps.push(map);if(settings["panorama"]==true){if(settings["panoramaEffect"].match(/^slide/)){if(settings["panoramaEffect"]=="slideLeft"){panorama_margin="0 0 0 "+$(that).css("width")}else if(settings["panoramaEffect"]=="slideRight"){panorama_margin="0 0 0 -"+$(that).css("width")}else if(settings["panoramaEffect"]=="slideUp"){panorama_margin=$(that).css("height")+" 0 0 0"}else if(settings["panoramaEffect"]=="slideDown"){panorama_margin="-"+$(that).css("height")+" 0 0 0"}}else{panorama_margin="0"}var panorama_pseudo=$("<div>",{class:"panorama-pseudo-container",style:"position:absoulute;top:0px;left:-0px;z-index:1;width:100%;height:100%;transition: margin 0.8s ease;margin:"+panorama_margin}).prependTo($(that)).get(0);panorama=new google.maps.StreetViewPanorama(panorama_pseudo,{position:center,addressControlOptions:{position:google.maps.ControlPosition.BOTTOM_CENTER},disableDefaultUI:!settings["panoramaControls"]});var panoramaCenterControl=document.createElement("div");var panoramaControl=new CreateControl("panoramaSlideOut",panoramaCenterControl,panorama);panorama.controls[google.maps.ControlPosition.TOP_RIGHT].push(panoramaControl)}if(settings["zoom"]==null){map.fitBounds(bounds)}if(settings["tilt"]!=null){map.setTilt(settings["tilt"])}}if(pins.length>0){setTimeout(render,settings["delay"])}};init();var render=function(){for(var i in pins){if(settings["animation"]!="none"){addMarkerWithTimeout(pins[i],i*200)}else{addMarker(pins[i])}}};var addMarker=function(pin){var _marker=new google.maps.Marker({position:pin.position,map:map,icon:pin.icon,info:pin.info});markers.push(_marker);if(pin.auto_open){pin.info.open(map,_marker)}if(typeof pin.info.content!="undefined"){_marker.addListener("click",function(){pin.info.open(map,_marker)})}};var addMarkerWithTimeout=function(pin,timeout){window.setTimeout(function(){addMarker(pin);if(pin.auto_open){setTimeout(function(){pin.info.open(map,_marker)},500)}},timeout)};var CreateControl=function(type,controlDiv,container){var controlUI=$("<div>",{style:"background: #fff;border: 2px solid #fff;border-radius:3px;box-shadow:0 2px 6px rgba(0,0,0,.3);cursor:pointer;margin:0 0 22px 0 text-align:center;"}).appendTo($(controlDiv));var controlText=$("<div>",{style:"color:rgb(25,25,25);font-family:Roboto,Arial,sans-serif;font-size:16px;line-height:38px;padding: 0 5px 0 5px"}).appendTo($(controlUI));if(type=="panoramaSlideIn"){$(controlText).text("Street view");$(controlUI).on("click",function(){$(that).find(".panorama-pseudo-container").css("margin","0")})}else if(type=="panoramaSlideOut"){$(controlText).text("X");$(controlUI).on("click",function(){$(that).find(".panorama-pseudo-container").css("margin",panorama_margin)})}}})}})(jQuery);